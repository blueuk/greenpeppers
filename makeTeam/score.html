<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Futsal Scout - Data Sync PRO (Auto)</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00f2fe; --secondary: #4facfe; --bg-dark: #0f111a;
            --card-bg: #1e2130; --input-bg: #0b0d14; --text-main: #ffffff;
            --text-dim: #a0aec0; --success: #28a745;
        }
        body { 
            font-family: 'Pretendard', sans-serif; background-color: var(--bg-dark); color: var(--text-main); 
            margin: 0; padding: 20px; scroll-behavior: smooth;
            -webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none;
        }
        .container { max-width: 800px; margin: 0 auto; padding-bottom: 50px; }
        
        /* ì´ˆê¸° ë¡œë”© í™”ë©´ */
        #setupView { text-align: center; padding: 50px 20px; }
        .loader { 
            border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); 
            border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; 
            margin: 20px auto; 
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* ì—ë””í„° UI */
        .status-panel { 
            background: #1e2130; padding: 25px; border-radius: 20px; margin-bottom: 25px; 
            border-left: 6px solid var(--primary); box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: sticky; top: 10px; z-index: 100;
        }
        .current-name { font-size: 1.8rem; font-weight: 800; color: var(--primary); margin-top: 5px; }
        .badge-existing { font-size: 0.7rem; background: var(--success); color: white; padding: 3px 10px; border-radius: 12px; margin-left: 12px; vertical-align: middle; font-weight: 600; }

        .form-card { background: var(--card-bg); border-radius: 24px; padding: 30px; border: 1px solid #333; }
        .stat-group { margin-bottom: 40px; }
        .group-title { font-size: 1.1rem; font-weight: 800; margin-bottom: 20px; color: var(--secondary); border-bottom: 2px solid #333; padding-bottom: 10px; }
        .stat-row { margin-bottom: 22px; }
        .stat-info { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.95rem; }
        .stat-value { color: var(--primary); font-weight: 800; }
        
        input[type="range"] { -webkit-appearance: none; width: 100%; height: 7px; background: #333; border-radius: 10px; outline: none; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 22px; height: 22px; background: var(--primary); border-radius: 50%; cursor: pointer; box-shadow: 0 0 10px rgba(0,242,254,0.4); }

        .action-box { 
            display: grid; grid-template-columns: 1fr 1.5fr 1.5fr; gap: 12px; margin-top: 35px; 
        }
        button { padding: 18px 10px; border-radius: 15px; border: none; font-weight: 800; cursor: pointer; font-size: 0.95rem; transition: 0.2s; }
        .btn-prev { background: #2d3446; color: white; }
        .btn-next { background: #3d455d; color: var(--primary); border: 1px solid var(--primary); }
        .btn-save { background: linear-gradient(45deg, var(--secondary), var(--primary)); color: #000; }
        button:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); opacity: 0.9; }
    </style>
</head>
<body oncontextmenu="return false" onselectstart="return false">

<div class="container">
    <div id="setupView">
        <h1 style="color: var(--primary); font-size: 1.8rem;">DATA SYNC SYSTEM</h1>
        <div id="loadingUI">
            <div class="loader"></div>
            <p id="statusTxt" style="color:var(--text-dim);">GitHub ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì¤‘...</p>
        </div>
        <button id="startBtn" onclick="initEditor()" style="display:none; width:100%; background:var(--primary); color:#000; padding: 20px; font-size: 1.1rem; border-radius: 15px; margin-top:20px;">ì—ë””í„° ì‹œì‘í•˜ê¸° â”</button>
    </div>

    <div id="editorView" style="display: none;">
        <div class="status-panel">
            <div>
                <div style="font-size:0.85rem; color:var(--text-dim); font-weight: 600;" id="progressText">0 / 0 ëª…</div>
                <div class="current-name" id="nowTarget">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>

        <div class="form-card">
            <div id="fields"></div>
            
            <div class="action-box">
                <button class="btn-prev" onclick="move(-1)">ì´ì „</button>
                <button class="btn-next" onclick="move(1)">ë‹¤ìŒ ì„ ìˆ˜</button>
                <button class="btn-save" onclick="saveAll()">ìµœì¢… ì €ì¥ ë° ì¢…ë£Œ</button>
            </div>
        </div>
    </div>
</div>

<script>
    /* ğŸ”’ ë³´ì•ˆ ë¡œì§ */
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.onkeydown = function(e) {
        if (e.keyCode === 123 || (e.ctrlKey && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74)) || (e.ctrlKey && e.keyCode === 85)) return false;
    };
    setInterval(() => { debugger; }, 1000);

    /* âš™ï¸ ì„¤ì • ë°ì´í„° */
    const scoreMap = [5, 10, 13, 16, 18];
    const scoreLabels = ["í•˜(5)", "ì¤‘í•˜(10)", "ì¤‘(13)", "ì¤‘ìƒ(16)", "ìƒ(18)"];
    const stats = {
        "ğŸƒ PHYSICAL": ["ëª¸ì‹¸ì›€", "ê· í˜•ê°", "ì²´ë ¥", "ìŠ¤í”¼ë“œ"],
        "ğŸ§  MENTAL": ["ë¦¬ë”ì‹­", "ì˜ì‚¬ì†Œí†µ", "ì§‘ì¤‘ë ¥", "ëŒ€ë‹´ì„±", "ì¹¨ì°©ì„±"],
        "ğŸ›¡ï¸ DEFENSE": ["ì¼ëŒ€ì¼ìˆ˜ë¹„", "ìˆ˜ë¹„ì§€ì›", "ìˆ˜ë¹„ìœ„ì¹˜ì„ ì •", "ëŒ€ì¸ë§ˆí¬", "ê°€ë¡œì±„ê¸°", "ë°˜ì‚¬ì‹ ê²½", "ê³µì¤‘ë³¼ì²˜ë¦¬(í‚¤í¼)"],
        "ğŸ¯ ATTACK": ["ì¼ëŒ€ì¼ëŒíŒŒ", "ì—°ê³„í”Œë ˆì´", "ê³µê²©ìœ„ì¹˜ì„ ì •", "ìŠ›íŒŒì›Œ", "ìŠ›ì •í™•ë„", "íŒ¨ìŠ¤", "ë¡±íŒ¨ìŠ¤", "ë“œë¦¬ë¸”"]
    };

    let targetNames = []; 
    let existingData = {}; 
    let currentIdx = 0;
    let finalResults = {}; 

    /* ğŸš€ ìë™ ë°ì´í„° ë¡œë“œ */
    async function autoFetch() {
        const listUrl = 'https://blueuk.github.io/greenpeppers/makeTeam/list.txt';
        const playerUrl = 'https://blueuk.github.io/greenpeppers/makeTeam/player.txt';
        const statusTxt = document.getElementById('statusTxt');

        try {
            // 1. ëª…ë‹¨ ë¡œë“œ
            const resList = await fetch(listUrl);
            const textList = await resList.text();
            targetNames = textList.split('\n').map(v => v.trim()).filter(v => v);

            // 2. ê¸°ì¡´ ë°ì´í„° ë¡œë“œ
            const resData = await fetch(playerUrl);
            const textData = await resData.text();
            const cleanText = "[" + textData.trim().replace(/,\s*$/, "") + "]";
            try {
                JSON.parse(cleanText).forEach(p => existingData[p.name] = p);
            } catch(e) { console.log("ê¸°ì¡´ ë°ì´í„°ê°€ ë¹„ì–´ìˆê±°ë‚˜ í˜•ì‹ì´ ë‹¤ë¦…ë‹ˆë‹¤."); }

            statusTxt.innerText = `ë¡œë“œ ì™„ë£Œ: ëª…ë‹¨ ${targetNames.length}ëª… / ê¸°ì¡´ ë°ì´í„° ${Object.keys(existingData).length}ê±´`;
            document.getElementById('loadingUI').style.display = 'none';
            document.getElementById('startBtn').style.display = 'block';

        } catch (err) {
            statusTxt.innerText = "ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨. URLì„ í™•ì¸í•˜ì„¸ìš”.";
            statusTxt.style.color = "#ff007b";
        }
    }

    function initEditor() {
        document.getElementById('setupView').style.display = 'none';
        document.getElementById('editorView').style.display = 'block';
        const container = document.getElementById('fields');
        for (const [group, list] of Object.entries(stats)) {
            const gDiv = document.createElement('div');
            gDiv.className = 'stat-group';
            gDiv.innerHTML = `<div class="group-title">${group}</div>`;
            list.forEach(s => {
                gDiv.innerHTML += `
                    <div class="stat-row">
                        <div class="stat-info"><span>${s}</span><span class="stat-value" id="val-${s}">-</span></div>
                        <input type="range" min="0" max="4" value="2" data-stat="${s}" oninput="sync(this, '${s}')">
                    </div>`;
            });
            container.appendChild(gDiv);
        }
        showPlayer();
    }

    function sync(el, stat) {
        document.getElementById(`val-${stat}`).innerText = scoreLabels[el.value];
    }

    function showPlayer() {
        const name = targetNames[currentIdx];
        const data = finalResults[name] || existingData[name];
        
        document.getElementById('nowTarget').innerHTML = name + (existingData[name] ? `<span class="badge-existing">ê¸°ì¡´ë°ì´í„°</span>` : "");
        document.getElementById('progressText').innerText = `${currentIdx + 1} / ${targetNames.length} ëª…`;

        document.querySelectorAll('input[type="range"]').forEach(input => {
            const stat = input.dataset.stat;
            if (data && data[stat] !== undefined) {
                const valIdx = scoreMap.indexOf(data[stat]);
                input.value = valIdx !== -1 ? valIdx : 2;
            } else { input.value = 2; }
            sync(input, stat);
        });
        window.scrollTo(0, 0);
    }

    function move(dir) {
        saveCurrent();
        const nextIdx = currentIdx + dir;
        if (nextIdx >= 0 && nextIdx < targetNames.length) {
            currentIdx = nextIdx;
            showPlayer();
        } else if (nextIdx >= targetNames.length) {
            alert("ë§ˆì§€ë§‰ ì„ ìˆ˜ì…ë‹ˆë‹¤. 'ìµœì¢… ì €ì¥'ì„ ëˆŒëŸ¬ ì™„ë£Œí•˜ì„¸ìš”.");
        }
    }

    function saveCurrent() {
        const name = targetNames[currentIdx];
        const pData = { name: name };
        document.querySelectorAll('input[type="range"]').forEach(i => {
            pData[i.dataset.stat] = scoreMap[i.value];
        });
        finalResults[name] = pData;
    }

    function saveAll() {
        saveCurrent();
        const output = targetNames.map(n => finalResults[n] || existingData[n]).filter(d => d);
        // JSON ê°ì²´ë“¤ì„ ì¤„ë°”ê¿ˆê³¼ ì‰¼í‘œë¡œ ì—°ê²°í•˜ì—¬ player.txt í˜•ì‹ ìƒì„±
        const finalStr = output.map(obj => JSON.stringify(obj)).join(",\n") + ",\n";
        
        const blob = new Blob([finalStr], { type: 'text/plain' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "player.txt";
        a.click();
        
        alert("ëª¨ë“  ë°ì´í„°ê°€ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìš´ë¡œë“œëœ íŒŒì¼ì„ í™•ì¸í•˜ì„¸ìš”.");
        location.reload();
    }

    window.onload = autoFetch;
</script>

</body>
</html>
