<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Futsal Scout - Weight Calculator v2.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00f2fe; --secondary: #4facfe; --bg-dark: #0f111a;
            --card-bg: #1e2130; --text-main: #ffffff; --text-dim: #a0aec0;
        }
        body { font-family: 'Pretendard', sans-serif; background-color: var(--bg-dark); color: var(--text-main); margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .header-box { text-align: center; margin-bottom: 30px; padding: 20px; background: var(--card-bg); border-radius: 20px; border: 1px solid #333; }
        h1 { color: var(--primary); margin: 0; font-size: 1.5rem; }
        .file-input-wrapper { display: flex; flex-direction: column; align-items: center; gap: 15px; margin-bottom: 20px; }
        input[type="file"] { background: #0b0d14; padding: 15px; border-radius: 12px; border: 1px solid #444; color: white; width: 100%; max-width: 400px; }
        .btn-calc { background: linear-gradient(45deg, var(--secondary), var(--primary)); border: none; padding: 20px; border-radius: 15px; font-weight: 800; cursor: pointer; width: 100%; font-size: 1.1rem; color: #000; transition: 0.2s; }
        .btn-calc:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0, 242, 254, 0.3); }
        .result-panel { margin-top: 30px; display: none; }
        .output-box { background: #000; color: #0f0; padding: 20px; border-radius: 15px; font-family: 'Courier New', monospace; font-size: 0.85rem; white-space: pre-wrap; border: 1px solid #222; max-height: 400px; overflow-y: auto; }
        .formula-info { font-size: 0.75rem; color: var(--text-dim); text-align: center; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header-box">
        <h1>POSITION SCORE CALCULATOR</h1>
        <p style="color:var(--text-dim); font-size:0.9rem;">ê³„ì‚°ë²•: (ê°€ì¤‘ì¹˜ í•©ì‚° / 20) Ã— 100</p>
    </div>

    <div class="file-input-wrapper">
        <label style="font-size:0.8rem; color:var(--secondary);">Step 1: player.txt (JSON) íŒŒì¼ ì„ íƒ</label>
        <input type="file" id="jsonInput" accept=".txt">
    </div>

    <button class="btn-calc" onclick="processData()">ê³„ì‚° ì‹œì‘ ë° players.txt ìƒì„± â”</button>
    <div class="formula-info">â€» ëª¨ë“  í¬ì§€ì…˜ ì ìˆ˜ëŠ” 100ì  ë§Œì  ê¸°ì¤€ìœ¼ë¡œ í™˜ì‚°ë©ë‹ˆë‹¤.</div>

    <div class="result-panel" id="resultPanel">
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
            <span style="font-size:0.8rem; color:var(--primary);">ìµœì¢… ê²°ê³¼ (ì´ë¦„|ê³¨|ì•„|í”½|í”¼)</span>
        </div>
        <div class="output-box" id="outputBox"></div>
    </div>
</div>

<script>
    const weights = {
        gol: { "ëª¸ì‹¸ì›€": 0.04, "ê· í˜•ê°": 0.04, "ìŠ¤í”¼ë“œ": 0.04, "ë¦¬ë”ì‹­": 0.03, "ì˜ì‚¬ì†Œí†µ": 0.04, "ì§‘ì¤‘ë ¥": 0.05, "ëŒ€ë‹´ì„±": 0.1, "ì¹¨ì°©ì„±": 0.04, "ì¼ëŒ€ì¼ìˆ˜ë¹„": 0.08, "ìˆ˜ë¹„ì§€ì›": 0.04, "ìˆ˜ë¹„ìœ„ì¹˜ì„ ì •": 0.1, "ë°˜ì‚¬ì‹ ê²½": 0.12, "ê³µì¤‘ë³¼ì²˜ë¦¬(í‚¤í¼)": 0.16, "íŒ¨ìŠ¤": 0.07, "ë¡±íŒ¨ìŠ¤": 0.05 },
        ala: { "ëª¸ì‹¸ì›€": 0.03, "ê· í˜•ê°": 0.04, "ì²´ë ¥": 0.08, "ìŠ¤í”¼ë“œ": 0.07, "ì˜ì‚¬ì†Œí†µ": 0.03, "ì§‘ì¤‘ë ¥": 0.01, "ì¼ëŒ€ì¼ìˆ˜ë¹„": 0.06, "ìˆ˜ë¹„ì§€ì›": 0.07, "ëŒ€ì¸ë§ˆí¬": 0.03, "ê°€ë¡œì±„ê¸°": 0.03, "ì¼ëŒ€ì¼ëŒíŒŒ": 0.08, "ì—°ê³„í”Œë ˆì´": 0.08, "ê³µê²©ìœ„ì¹˜ì„ ì •": 0.06, "ìŠ›íŒŒì›Œ": 0.07, "ìŠ›ì •í™•ë„": 0.07, "íŒ¨ìŠ¤": 0.06, "ë¡±íŒ¨ìŠ¤": 0.05, "ë“œë¦¬ë¸”": 0.08 },
        fix: { "ëª¸ì‹¸ì›€": 0.06, "ê· í˜•ê°": 0.04, "ì²´ë ¥": 0.04, "ìŠ¤í”¼ë“œ": 0.01, "ë¦¬ë”ì‹­": 0.04, "ì˜ì‚¬ì†Œí†µ": 0.02, "ì§‘ì¤‘ë ¥": 0.01, "ì¹¨ì°©ì„±": 0.01, "ì¼ëŒ€ì¼ìˆ˜ë¹„": 0.1, "ìˆ˜ë¹„ì§€ì›": 0.08, "ìˆ˜ë¹„ìœ„ì¹˜ì„ ì •": 0.1, "ëŒ€ì¸ë§ˆí¬": 0.1, "ê°€ë¡œì±„ê¸°": 0.11, "ë°˜ì‚¬ì‹ ê²½": 0.08, "ê³µê²©ìœ„ì¹˜ì„ ì •": 0.02, "ìŠ›íŒŒì›Œ": 0.02, "ìŠ›ì •í™•ë„": 0.01, "íŒ¨ìŠ¤": 0.09, "ë¡±íŒ¨ìŠ¤": 0.06 },
        piv: { "ëª¸ì‹¸ì›€": 0.08, "ê· í˜•ê°": 0.04, "ì²´ë ¥": 0.04, "ìŠ¤í”¼ë“œ": 0.05, "ë¦¬ë”ì‹­": 0.01, "ì˜ì‚¬ì†Œí†µ": 0.01, "ì§‘ì¤‘ë ¥": 0.02, "ëŒ€ë‹´ì„±": 0.03, "ì¹¨ì°©ì„±": 0.02, "ì¼ëŒ€ì¼ìˆ˜ë¹„": 0.03, "ìˆ˜ë¹„ì§€ì›": 0.04, "ê°€ë¡œì±„ê¸°": 0.03, "ì¼ëŒ€ì¼ëŒíŒŒ": 0.05, "ì—°ê³„í”Œë ˆì´": 0.11, "ê³µê²©ìœ„ì¹˜ì„ ì •": 0.1, "ìŠ›íŒŒì›Œ": 0.12, "ìŠ›ì •í™•ë„": 0.13, "íŒ¨ìŠ¤": 0.05, "ë“œë¦¬ë¸”": 0.04 }
    };

    function processData() {
        const fileInput = document.getElementById('jsonInput');
        if (!fileInput.files[0]) return alert("íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");

        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const rawText = e.target.result.trim();
                const jsonArrayText = "[" + rawText.replace(/,\s*$/, "") + "]";
                const players = JSON.parse(jsonArrayText);

                let finalLines = players.map(p => {
                    const g = calculateScore(p, weights.gol);
                    const a = calculateScore(p, weights.ala);
                    const f = calculateScore(p, weights.fix);
                    const v = calculateScore(p, weights.piv);
                    return `${p.name}|${g}|${a}|${f}|${v}`;
                });

                const resultText = finalLines.join('\n');
                document.getElementById('outputBox').innerText = resultText;
                document.getElementById('resultPanel').style.display = 'block';
                downloadFile(resultText);

            } catch (err) {
                alert("íŒŒì¼ í˜•ì‹ ì˜¤ë¥˜ì…ë‹ˆë‹¤.");
            }
        };
        reader.readAsText(fileInput.files[0]);
    }

    function calculateScore(player, weightMap) {
        let weightedSum = 0;
        for (const [stat, weight] of Object.entries(weightMap)) {
            const val = player[stat] || 10;
            weightedSum += val * weight;
        }

        // ğŸ’¡ í•µì‹¬ ë¡œì§ ë³€ê²½: (ê°€ì¤‘ì¹˜ í•©ì‚° ì ìˆ˜ / 20) * 100
        const finalScore = (weightedSum / 20) * 100;
        return finalScore.toFixed(1);
    }

    function downloadFile(text) {
        const blob = new Blob([text], { type: 'text/plain' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "players.txt";
        a.click();
    }
</script>

</body>
</html>